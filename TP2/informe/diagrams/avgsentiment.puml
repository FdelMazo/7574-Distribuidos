@startuml
!theme minty

skinparam PartitionFontColor black
skinparam LegendFontColor black
skinparam ArrowFontColor black
skinparam NoteBackgroundColor lemonchiffon
skinparam NoteFontColor black
skinparam backgroundColor white
skinparam ConditionEndStyle hline

partition "Allow the user to download the highest sentiment post" {
  start
  -> ( type,... );
  :Source;
  if (type) then (post)
    :PostsWorker;
    -> ( post_id,meme_url );
  else (comment)
    :CommentsWorker;
    note right
      transform permalink
      into post_id
    endnote
    -> ( post_id,sentiment );
    #ff8662 :CommentsSentimentAverager;
    note right
      aggregate by post
    endnote
    -> ( post_id,sentiment_avg );
    #ff8662 :CommentsSentimentsMaxer;
    note right
      keep track of the max
    endnote
  endif
  -> ( post_id, meme_url );
  #ff8662 :Joiner;
  -> ( meme_url );
  :ImageStreamer;
  -> bytes(meme_url);
  stop

  legend bottom right
      |= |Worker Type|
      |<#56cc9d>| Stateless & Scalable|
      |<#ff8662>| Stateful & Unique|
  endlegend
}

@enduml


