@startuml
!theme minty

skinparam PartitionFontColor black
skinparam LegendFontColor black
skinparam ArrowFontColor black
skinparam ArrowFontSize 9
skinparam NoteBackgroundColor lemonchiffon
skinparam NoteFontColor black
skinparam backgroundColor white

skinparam ArrowFontColor black
skinparam NoteBackgroundColor lemonchiffon
skinparam NoteFontColor black
skinparam backgroundColor white
skinparam ConditionEndStyle hline

start
-> ...( type,...,id )...;
:Source;
if (type) then (post)
    :PostsWorker;
else (comment)
  :CommentsWorker;
  split
  -> ...( id,sentiment )...;
  #ff8662 :SentimentAverager; 
  -> ...( id,sentiment_avg )...;
  split again
  -> ...( id,body )...;
  #ff8662 :StudentDecider; 
  -> ...( id,is_student_related )...;
  end split
endif
-> -->...( id,score,permalink,url )...\n     ...( id,is_student_related )...<--\n     ...( id,sentiment_avg )...      <--;
#ff8662 :Joiner;
-> <post with lots of metadata>;
#ff8662 :Filterer;
note right
  push into the respective metrics
  only if they meet the criteria
endnote
-> <metrics>;
split
  stop
split again
  stop
endsplit

legend bottom right
    |= |Worker Type|
    |<#56cc9d>| Stateless & Scalable|
    |<#ff8662>| Stateful & Unique|
endlegend
@enduml

